let loaded,data,isBusy,activeItem,activeReferences,needIpaSelector,activeInitial,selfHashChange,setTimeoutHide,explainerShowing,searchTimeout,searchText,searchListHasTouch,langButtonPressed,ipaConversion={},ipaType="broad",langLong=navigator.language||"en-US",langShort=langLong.replace(/-.+/,"");const hashes={},allEntries=[],stats={},idx=[],diacriticsMap={},diacriticsRegex=/[\u0300-\u036F]/g,diacriticsAtStartRegex=/^[\u0300-\u036F]*/,cjkLanguages=["zh"],diacriticsRemovalMap=[{base:"a",letters:"â±¥"},{base:"aa",letters:"êœ³"},{base:"ae",letters:"Ã¦"},{base:"ao",letters:"êœµ"},{base:"au",letters:"êœ·"},{base:"av",letters:"êœ¹êœ»"},{base:"ay",letters:"êœ½"},{base:"b",letters:"Æ€ÆƒÉ“"},{base:"c",letters:"ÆˆÈ¼"},{base:"d",letters:"Ä‘ÆŒÉ–É—êº"},{base:"e",letters:"É‡"},{base:"f",letters:"Æ’ê¼"},{base:"g",letters:"Ç¥É ê¡áµ¹"},{base:"h",letters:"Ä§â±¨"},{base:"hv",letters:"Æ•"},{base:"i",letters:"É¨Ä±"},{base:"j",letters:"É‰"},{base:"k",letters:"Æ™â±ªêêƒê…ê£"},{base:"l",letters:"Å‚ÆšÉ«â±¡ê‰êê‡"},{base:"m",letters:"É±"},{base:"n",letters:"ÆÉ²ê‘ê¥"},{base:"o",letters:"Ã¸Ã¸ê‹êÉµ"},{base:"oi",letters:"Æ£"},{base:"ou",letters:"È£"},{base:"oo",letters:"ê"},{base:"p",letters:"Æ¥áµ½ê‘ê“ê•"},{base:"q",letters:"É‹ê—ê™"},{base:"r",letters:"ÉÉ½ê›ê§êƒ"},{base:"s",letters:"È¿ê©ê…"},{base:"ss",letters:"ÃŸ"},{base:"t",letters:"Å§Æ­Êˆâ±¦ê‡"},{base:"tz",letters:"êœ©"},{base:"u",letters:"Ê‰"},{base:"v",letters:"Ê‹êŸ"},{base:"vy",letters:"ê¡"},{base:"w",letters:"â±³"},{base:"y",letters:"Æ´Éá»¿"},{base:"z",letters:"Æ¶È¥É€â±¬ê£"},{base:"'",letters:"â€˜â€™"}];function initialise(){$("html").attr("lang",langLong),document.title=getString("title")+" â€“ "+getString("title-text"),$("h1").removeClass("hidden");let e=data.strings["available-languages"],a=[];$.each(e,(function(e,t){a.push(e)})),a.includes(langLong)||(a.includes(langShort)||(langShort="en"),langLong=langShort),$("span[data-string-id]").each((function(){const e=getString($(this).data("string-id"));e&&$(this).html(e)})),$("#search-input").attr("placeholder",getString("search-box-placeholder")),$(".lang-button").text(e[langLong]),cjkLanguages.includes(langShort)&&$(".content").addClass("content-cjk"),$(".tabs-container .tab").each((function(){const e=$(this).data("header");data.items[e]&&$(this).removeClass("tab-disabled")})),$(".tabs-container .tab").click((function(){if(isBusy)return;const e=$(this);if(e.hasClass("tab-selected")||e.hasClass("tab-disabled"))return;animateLoadIndex(e.data("header"))})),$("#ipa-explainer-container").hover((function(){clearTimeout(setTimeoutHide)}),hideIpaExplainer).focusout(hideIpaExplainer),$("#ipa-explainer .ipa-notes-button").click((function(){"#IPA_Notes"!==window.location.hash?window.open("#IPA_Notes"):hideIpaExplainer()}));for(var t=0;t<diacriticsRemovalMap.length;t++)for(var s=diacriticsRemovalMap[t].letters,n=0;n<s.length;n++)diacriticsMap[s[n]]=diacriticsRemovalMap[t].base;function i(){const e=$("#search-list-container");e.hasClass("needs-to-close")&&($("#search-input").removeClass("fake-focus"),e.removeClass("needs-to-close").hide(),$(".search-list-shadow-caster").hide())}$.each(data.items,(function(e,a){a.forEach((function(a){let t=a.title.replaceAll("|","").replaceAll(" ","_");if(a.forms){let e=allEntries.push({hash:t,entry:a})-1,s=-1;a.forms.forEach(a=>{s++,a.type&&a.text&&a.prons&&a.type.endsWith("name")&&(idx.push({words:toSearchForm(a.text).split(" "),text:a.text,entryId:e,formId:s,extraScore:0===s?10:5}),a.alt&&a.alt.forEach(a=>{idx.push({words:toSearchForm(a).split(" "),text:a,entryId:e,formId:s,extraScore:0===s?8:5})}),a.prons.forEach(a=>{let t=a.match(/\{\{lang\|[a-zA-Z\-]+\|([^{|}]+)(?=(\|[^{|}]*)*\}\})/g);if(t||(t=[]),a.includes("{{ruby|")){let e=a.replace(/\{\{ruby\|([^\{\|\}]+)\|([^\{\|\}]+)\}\}/g,"$1"),s=a.replace(/\{\{ruby\|([^\{\|\}]+)\|([^\{\|\}]+)\}\}/g,"$2");t=t.concat(e.match(/\{\{lang\|[a-zA-Z\-]+\|([^{|}]+)(?=(\|[^{|}]*)*\}\})/g)||[]).concat(s.match(/\{\{lang\|[a-zA-Z\-]+\|([^{|}]+)(?=(\|[^{|}]*)*\}\})/g)||[])}t.forEach(t=>{let n=t.match(/\|([a-zA-Z\-]+)\|/)[1];t=t.replace(/.+\|/,""),idx.push({words:toSearchForm(t).split(" "),text:t,entryId:e,formId:s,lang:n,extraScore:/^[^\}]*\|(tran|aprx)/.test(a)?0:5})})}))})}hashes[t]={initial:e,item:a}}))})),stats.entries=allEntries.length,$.each(data.ipaConversion,(function(e,a){let t={};$.each(a,(function(e,a){let s=[];a.forEach((function(e){s.push([new RegExp(e[0],"g"),e[1]])})),t[e]=s})),ipaConversion[e]=t})),$("#search-input").on("input focus",(function(){let e=$(this).val();searchText!==e&&(searchText=e,searchTimeout&&clearTimeout(searchTimeout),""!==e?searchTimeout=setTimeout(()=>{searchTimeout=void 0,onSearch(e)},300):($(".search-list-shadow-caster").hide(),$("#search-list-container").hide()))})),$("#search-input").focusout((function(){searchTimeout&&clearTimeout(searchTimeout),searchText=void 0,$("#search-list-container").is(":hover")||searchListHasTouch?($(this).addClass("fake-focus"),$("#search-list-container").addClass("needs-to-close")):($(".search-list-shadow-caster").hide(),$("#search-list-container").hide())})),$("#search-list-container").on("touchstart touchmove",(function(){searchListHasTouch=!0})),$("#search-list-container").on("mouseleave touchend touchcancel",(function(){searchListHasTouch?setTimeout(()=>{searchListHasTouch=!1,i()},500):i()})),$("html").on("touchend",(function(){$(".touch-highlight").removeClass("touch-highlight")}));const l=$("#lang-list");a.forEach(a=>{const t=$('<div class="lang-list-item">').data("lang",a).html(expandTemplates("{{lang-code|"+a+"}} {{lang|"+a+"|"+e[a]+"}}"));l.append(t)}),l.find(".lang-list-item").click((function(){let e=$(this).data("lang");langLong=e,langShort=e.replace(/-.*/,""),changeLanguage()}));const r=$("#lang-list-container");$(".lang-button").click((function(){let e=r.outerWidth(),a=$(window).width(),t=$(".lang-button").position().left+$(".lang-button").outerWidth()/2-e/2;t+e>a-10&&(t=a-10-e),r.css("left",t),r.show(200)})),$(".lang-button, .lang-container").click((function(){langButtonPressed=!0,setTimeout(()=>{langButtonPressed=!1},1e3)})),$("body").click((function(){r.is(":visible")&&!langButtonPressed&&r.hide()})),$(window).on("resize",onResize),$(window).on("hashchange",onHashChange),onHashChange()}function changeLanguage(){$("html").attr("lang",langLong),document.title=getString("title")+" â€“ "+getString("title-text"),$("span[data-string-id]").each((function(){const e=getString($(this).data("string-id"));e&&$(this).html(e)})),$("#search-input").attr("placeholder",getString("search-box-placeholder")),$(".lang-button").text(data.strings["available-languages"][langLong]||langLong),cjkLanguages.includes(langShort)?$(".content").addClass("content-cjk"):$(".content").removeClass("content-cjk"),onResize(),selfHashChange="",onHashChange()}function onResize(){$("#lang-list-container").hide(),$("#ipa-explainer-container").hide()}function toSearchForm(e){return e.replace(/[-â€“Â·ãƒ»ã‚ ,.ï¼Œã€‚ã€]/g," ").normalize("NFKD").toLowerCase().replace(diacriticsRegex,"").replace(/[^\u0000-\u007E]/g,e=>diacriticsMap[e]||e).replace(/\s+/g," ").trim().normalize("NFC")}function makeHighlights(e,a){let t,s=toSearchForm(e).split(" "),n=1===s.length,l=toSearchForm(a).split(" "),r=s.map(e=>backtrackSearch(e,l,1,n?1e4:1,!0)),c=!0;if(r.forEach(e=>c&=e.score>=0),c){let s=toSearchForm(a);r.forEach(e=>{let a=0;e.hl.forEach(e=>{for(let t=0;t<e.length;t++,a++)"+"===e[t]&&(s=s.substr(0,a)+"+"+s.substr(a+1));a++})}),i=0,t="";let n=a;for(;a.length>0;){let l=a.charAt(0),r=(a=a.substr(l.length)).match(diacriticsAtStartRegex);l+=r[0],a=a.substr(r[0].length);let c=toSearchForm(l);if(""===c){e.includes(l)?t+="<<"+htmlEncode(l)+">>":t+=htmlEncode(l);continue}for(;" "===s[i];)i++;let o=s.substr(i,c.length);if(i+=c.length,o.includes("+"))t+="<<"+htmlEncode(l)+">>";else{if(o!==c)return htmlEncode(n);t+=htmlEncode(l)}}return t=t.replace(/>><</g,"").replace(/<</g,'<span class="search-item-highlight">').replace(/>>/g,"</span>"),t}return htmlEncode(a)}function onSearch(e){e.length>100&&(e=e.substr(0,100));let a=e,t=search(e=toSearchForm(e));const s=$("#search-list-container").css("width",$("#search-input").outerWidth()-2),n=s.find("#search-list").html("");t&&t.length>0?(s.find(".search-list-no-results").addClass("hidden"),t.forEach(e=>{const t=$('<div class="search-list-item">').data("entry-id",e.entryId);let s=allEntries[e.entryId].hash.replaceAll("_"," ");const i=$('<div class="search-item-header">').html(makeHighlights(a,s));t.append(i);let l=allEntries[e.entryId].entry;const r=$('<div class="search-item-subheader">').html(htmlEncode(getString("form-type-"+l.forms[e.formId].type))+htmlEncode(e.lang?" ("+getString("lang-"+e.lang)+")":"")+htmlEncode(getString("colon"))+(e.lang?'<span lang="'+e.lang+'">':"")+makeHighlights(a,e.text)+(e.lang?"</span>":""));t.append(r),n.append(t)})):s.find(".search-list-no-results").removeClass("hidden"),s.find(".search-list-item").click((function(){let e=$(this).data("entry-id"),a=allEntries[e]&&allEntries[e].hash;a&&(activeInitial=hashes[a].initial,activeItem=hashes[a].item,animateLoadActiveItem(),$("#search-input").val(""),$(".search-list-shadow-caster").hide(),$("#search-list-container").hide())})),s.show();const i=$(".search-list-shadow-caster");i.css("width",s.outerWidth()).css("height",s.outerHeight()-20).css("top",s.position().top+20),i.show()}function search(e){let a=e.split(" ").filter(e=>""!==e),t=!0,s=1===a.length,n=[];a.forEach(e=>{(t?idx:n).forEach(a=>{let i=backtrackSearch(e,a.words,1,s?1e4:1).score;i>=0?t&&n.push({score:i,extraScore:a.extraScore||0,words:a.words,text:a.text,entryId:a.entryId,formId:a.formId,lang:a.lang}):t||(a.removed=!0)}),t=!1}),n=n.filter(e=>!e.removed),n.sort((e,a)=>a.score+a.extraScore-e.score-e.extraScore||e.entryId-a.entryId||e.formId-a.formId),a.forEach(e=>{n.forEach(a=>{backtrackSearch(e,a.words,0,s?1e4:1).score<0&&(a.removed=!0)})});let i=n.filter(e=>!e.removed);i.length>0&&(n=i);let l=[];i=[];for(let e=0;e<n.length;e++){let a=n[e].entryId;l.includes(a)||(l.push(a),i.push(n.filter(e=>e.entryId===a).sort((e,a)=>a.score-e.score||(0===e.formId?1:0===a.formId?-1:e.formId-a.formId))[0]))}return n=i,n.length>10&&(n=n.slice(0,10)),0!==n.length&&n}$.getJSON("./data.json?_v="+Math.floor(Date.now()/864e5-1/6),(function(e){data=e,loaded&&initialise()})),$((function(){loaded=!0,data&&initialise()})),String.prototype.replaceAll=function(e,a){if("string"==typeof e){a=a.toString();let t=0,s=this;for(;;){let n=s.indexOf(e,t);if(-1===n)break;s=s.substring(0,n)+a+s.substring(n+e.length),t=n+a.length}return s}};const adjacentPairScore=3,fuzzyPointScore=10,initialOnlyBonus=1,fullWordBonus=5;function backtrackSearch(e,a,t,s,n){if(n){var i=[];a.forEach(e=>i.push(e))}if(""===e)return{score:10*t,hl:i};if(0===s)return{score:-1e4,hl:i};s||(s=1e4);let l=-1e4,r=e;function c(e,t,s){if(e.score>l&&e.score>=0&&(l=e.score,n)){i=[];for(let n=0;n<a.length;n++)n===t?i.push(s):n<t?i.push(e.hl[n]):n>t&&i.push(e.hl[n-1])}}for(let i=0;i<a.length;i++){e=r;let l=a[i],o=l;if("'"===l[0]&&"'"!==e[0]&&(e="'"+e),e[0]!==l[0])continue;let p=[],d=0;for(let e=0;e<a.length;e++)e!==i&&p.push(a[e]);let h=!1,g=!0;for(let a=0;a<l.length;a++)if(e[0]===l[a]){h&&(d+=3),h=!0,!n||0===a&&"-"===l[a]||(o=o.substr(0,a)+"+"+o.substr(a+1));let r=backtrackSearch(e=e.substr(1),p,t,s-1,n);if(r.score+=d,0===a&&(r.score+=1),g&&a===l.length-1&&(r.score+=5),c(r,i,n&&o),t>0){let r=backtrackSearch(e.substr(1),p,t-1,s-1,n);r.score+=d,g&&a===l.length-1&&(r.score+=5),c(r,i,n&&o)}}else if(h=!1,g=!1,t>0&&e[1]&&e[1]===l[a]){p.push("-"+l.substr(a));let r=backtrackSearch("-"+e.substr(1),p,t-1,s,n);if(r.score+=d,n){let t=r.hl.pop().replace("-",o.substr(0,a));e[0]===l[a+1]&&"+"!==t[a+1]&&(t=t.substr(0,a+1)+"+"+t.substr(a+2),r.score+=3),c(r,i,t)}else c(r,i);p.pop()}}return{score:l,hl:i}}function onHashChange(){if(decodeURI(window.location.hash)===selfHashChange)return;selfHashChange="",$(".tabs-container .tab").removeClass("tab-selected");const e=(decodeURI(window.location.hash)||"#").substring(1);1===e.length&&data.items[e]?(activeInitial=e,$(".tabs-container .tab[data-header="+e+"]").addClass("tab-selected"),loadIndex(e)):hashes[e]?(activeInitial=hashes[e].initial,activeItem=hashes[e].item,loadActiveItem()):e.startsWith("debug-")&&ipaConversion[e.substr(6)]?debugLoadLanguage(e.substr(6)):(activeInitial="A",$(".tabs-container .tab[data-header=A]").addClass("tab-selected"),loadIndex("A")),$("html").scrollTop()>$(".content").offset().top&&$("html").scrollTop($(".content").offset().top)}function debugLoadLanguage(e){$("h1#the-h1").removeClass("index-h1").text(getString("lang-"+e)),document.title=getString("title")+" â€“ "+getString("title-text");const a=$("#content");a.html(""),ipaType="debug",$(".under-header").html(getIpaSelectors());let t=new RegExp("\\{\\{ip[ab]\\|"+e+"\\|[^\\}]*\\}\\}");$.each(data.items,(function(e,s){s.forEach((function(e){e.forms&&e.forms.forEach((function(e){e.prons&&e.prons.forEach((function(e){let s=e.match(t);if(s){let t=s[0];s=e.match(/\{\{audio\|.*?\}\}/),s&&(t+=" "+s[0]),a.append($("<div>").html(expandTemplates(t)))}}))}))}))})),$("span.audio").click((function(){$(this).children("audio")[0].play()})),changeIpaType("std")}function animateLoadIndex(e){const a=$(".tabs-container .tab[data-header="+e+"]");data.items[e]&&(isBusy=!0,$(".content").animate({opacity:0},200,"linear",(function(){selfHashChange="#"+e,window.location.hash="#"+e,$(".tab-selected").removeClass("tab-selected"),loadIndex(e),a.addClass("tab-selected"),$(".content").animate({opacity:1},200,"linear",(function(){isBusy=!1}))})),$("html").scrollTop()>$(".content").offset().top&&$("html").animate({scrollTop:$(".content").offset().top},300))}function getIpaSelectors(e){const a=$('<span class="ipa-selectors">').html(getString("ipa-selector-prefix")+'<span class="fake-link ipa-selector" data-ipa-type="broad">'+getString("ipa-selector-broad")+'</span> Â· <span class="fake-link ipa-selector" data-ipa-type="std'+(e?"*":"")+'">'+getString("ipa-selector-std")+(e?"":'</span><span class="hide-if-audio-is-std"> Â· <span class="fake-link ipa-selector" data-ipa-type="audio">'+getString("ipa-selector-audio"))+("debug"===ipaType?'</span> Â· <span class="fake-link ipa-selector" data-ipa-type="debug">Plain':"")+"</span></span>");return!e||"audio"!==ipaType&&"std"!==ipaType||(ipaType="std*"),(!e&&"std*"===ipaType||"debug"===ipaType)&&(ipaType="std"),a.find("span.ipa-selector[data-ipa-type="+ipaType.replace("*","\\*")+"]").addClass("selected"),a.find("span.ipa-selector").click((function(){const e=$(this);e.hasClass("selected")||($("span.ipa-selectors span.ipa-selector").removeClass("selected"),e.addClass("selected"),changeIpaType(e.data("ipa-type")))})),a}function loadIndex(e){if(!data.items[e])return;const a=$("#content");a.html(""),$("#the-h1").addClass("index-h1").text(e),activeInitial=e,document.title=getString("title")+" â€“ "+getString("title-text"),$(".under-header").html(getIpaSelectors(!0));const t=getTranslitRegex();data.items[e].forEach((function(s){const n=$('<div class="index-item">');n.data("item",s),n.append($('<span><span class="bold-term">'+s.title.replace("|","</span>")+"</span>")),1===e.length&&s.forms&&s.forms[0].prons&&s.forms[0].prons.forEach((function(e){var a=e.match(/[> ]*^\{\{(en)\|orig[^}]*\}\} \/([^\/]+)\//);a?n.append($('<span> <span class="center-dot">â‹…</span>&nbsp;<span class="lang-code" title="'+langName(a[1])+'">'+a[1]+"</span> /"+expandTemplates(a[2],"index")+"/</span>")):(a=e.match(/^[> ]*\{\{([^|}+]+)[^|}]*\|orig[^}]*\}\} (\{\{ip[ab]\|[^\}]+\}\})/))?n.append($('<span> <span class="center-dot">â‹…</span>&nbsp;<span class="lang-code" title="'+langName(a[1])+'">'+a[1]+"</span> "+expandTemplates(a[2],"index")+"</span>")):(a=e.match(/^[> ]*\{\{([^|}+]+)[^|}]*\|orig[^}]*\}\} (.*?) (\{\{ip[ab]\|[^\}]+\}\})/))?n.append($('<span> <span class="center-dot">â‹…</span>&nbsp;<span class="lang-code" title="'+langName(a[1])+'">'+a[1]+"</span> "+expandTemplates(a[2],"index")+" "+expandTemplates(a[3],"index")+"</span>")):((a=e.match(/^[> ]*\{\{en\|aprx[^}]*\}\} (\{\{ip[ab]\|[^\}]+\}\})/))&&n.append($('<span> <span class="center-dot">â‹…</span>&nbsp;<span class="lang-code" title="'+langName("en").replace(/^(.+)$/,langName("aprx"))+'">en~</span> '+expandTemplates(a[1],"index")+"</span>")),t&&(a=e.match(t))&&n.append($('<span> <span class="center-dot">â‹…</span>&nbsp;<span class="index-translit">'+a[1]+"</span>")))})),n.click(onIndexItemClick),n.on("touchstart",(function(){$(this).addClass("touch-highlight")})),a.append(n)})),changeIpaType(ipaType)}function loadActiveItem(){if(!activeItem)return;activeReferences=[],needIpaSelector=!1;const e=$("#content");e.html("");let a=activeItem["alt-title"]&&(activeItem["alt-title"][langLong]||activeItem["alt-title"][langShort]||activeItem["alt-title"].en)||activeItem.title;document.title=a.replace("|","")+" - "+getString("title");let t=a.replace("|,",",|").replace(/\|(.*)/,'<span class="h1-lighter">$1</span>');activeItem.forms||(t='<span class="no-sc">'+t+"</span>"),$("#the-h1").removeClass("index-h1").html(t);const s=$(".under-header").html("");if(1===activeInitial.length){const e=$('<span class="fake-link">').text(getString("back-button"));e.click((function(){1===activeInitial.length&&animateLoadIndex(activeInitial)})),s.append(e),activeItem.forms&&(s.append($('<span class="under-header-separator">')),s.append(getIpaSelectors()))}if(activeItem.notes&&activeItem.notes.forEach(e=>{let a="string"==typeof e?e:e[langLong]||e[langShort]||e.en||"";activeReferences.push(expandTemplates(a))}),activeItem.desc){let a=activeItem.desc.split("|"),t=getString("desc-template-"+a[0]);t=t.replaceAll("$o","{{occ|"+a[1].replaceAll(" ","|")+"}}"),t=t.replaceAll("$c","{{and|"+a[2].split(" ").map(e=>"{{string|dem-"+e+"|"+e+"}}").join("|")+"}}");let s=a[3].includes(" ")?"{{"+a[3].replaceAll(" ","|").replace(/^c\|/,"circa|")+"}}":a[3];if(a[4])if("%"===a[4])t=t.replaceAll("$y",s);else{let e=a[4].includes(" ")?"{{"+a[4].replaceAll(" ","|").replace(/^c\|/,"circa|")+"}}":a[4];t=t.replaceAll("$y","{{lifespan|"+s+"|"+e+"}}")}else t=t.replaceAll("$y","{{born|"+s+"}}");e.append($('<div class="entry-description">').html(expandTemplates(t)))}if(activeItem.content||activeItem.intro){if(activeItem.content){var n=ipaType;ipaType="std"}let a=activeItem.content||activeItem.intro;"object"==typeof a&&(a=a[langLong]||a[langShort]||a.en||""),Array.isArray(a)&&(a=a.join(" ")),e.append($('<div class="content-article">').html(expandTemplates(a)))}if(activeItem.forms){e.append($("<h2>"+getString("header-pronunciation")+"</h2>"));let a=0;activeItem.forms.forEach((function(t){let s=!1;if(e.append($("<h3>"+t.text+' <span class="text-tag h3-space-before">'+getString("form-type-"+t.type)+"</span></h3>")),t.alt&&e.append($('<div class="alternative-spellings">').html(getString("alternative-spellings")+" "+t.alt.map(e=>'<span class="alternative-spelling">'+htmlEncode(e)+"</span>").join(", "))),t.prons){const n=$('<ul class="pron-list">');t.prons.forEach((function(e){let t=0,i=!1;for(e.startsWith("*")&&(i=!0,e=e.substring(1));e.startsWith(">");)t++,e=e.substring(1);i&=!((e=e.trim()).startsWith("{{"+langShort+"|")||e.startsWith("{{"+langShort+"}")),s|=i,n.append($('<li class="level-'+t+(i?" pron-optional-"+a+" hidden":"")+'">').html(expandTemplates(e)))})),e.append(n)}if(s){const t=$('<div><span class="expander">â· '+getString("show-more")+"<span></div>");e.append(t),t.find(".expander").data("expanded","false").data("target","pron-optional-"+a).click((function(){const e=$(this),a=e.data("target");"true"===e.data("expanded")?(e.data("expanded","false").text("â· "+getString("show-more")),$("li."+a).addClass("hidden")):(e.data("expanded","true").text("â¶ "+getString("show-less")),$("li."+a).removeClass("hidden"))})),a++}}))}if(activeItem.links){e.append($("<h2>"+getString("header-external-links")+"</h2>"));const a=$("<ul>");activeItem.links.forEach((function(e){e=expandTemplates(e),a.append($("<li>").html(e))})),activeItem.wd&&/Q[0-9]+/.test(activeItem.wd)&&a.append($("<li>").html(expandTemplates("{{wikidata|"+activeItem.wd+"}}"))),e.append(a)}if(activeReferences.length>0){e.append($("<h2>"+getString("header-references")+"</h2>"));const a=$('<ol class="reference-list">');let t=0;activeReferences.forEach((function(e){e=expandTemplates("{{"+e+"}}")||expandTemplates("{{string|"+e+"}}")||expandTemplates(e),a.append($('<li id="ref-'+ ++t+'">').html(e))})),e.append(a)}initPage(),n&&(ipaType=n)}function initPage(){let e=ipaType;$("div[data-require]").each((function(){const a=$(this);let t=a.data("require");$.ajax({url:"/content/"+t+"?_v="+Math.floor(Date.now()/864e5-1/6),success:function(t){a.removeAttr("data-require").html(expandTemplates(t));let s=ipaType;ipaType=e,initPage(),ipaType=s},error:function(){a.removeAttr("data-require").addClass("content-ajax-fail").html(getString("content-ajax-fail"))}})})),$(".ref-link").click((function(){let e=$("html")[0];$("html").animate({scrollTop:e.scrollHeight-e.clientHeight},300)})),$("span.audio").click((function(){$(this).children("audio")[0].play()})),changeIpaType(ipaType),needIpaSelector?"std"===needIpaSelector&&$("span.hide-if-audio-is-std").addClass("hidden"):$(".ipaSelectors").addClass("hidden")}function changeIpaType(e){ipaType=e,$("span.ipa[data-src]").each((function(){const a=$(this);a.html(getIpa(a.data("src"),a.data("lang"),a.hasClass("ipa-broad")?"broad":a.hasClass("ipa-keep")?"keep":e))})),$("span.ipa-word").click(onIpaClick).hover((function(){}),(function(){clearTimeout(setTimeoutHide),setTimeoutHide=setTimeout(()=>{hideIpaExplainer()},500)}))}const ipaComponentMaxLength=6;function onIpaClick(){clearTimeout(setTimeoutHide);const e=$("#ipa-explainer-container"),a=$("body"),t=$(this).closest("span.ipa-word"),s=t.text().normalize("NFD"),n=t.position();let i="",l=!1;for(let e=0;e<s.length;e++){if("-,".includes(s[e])){i+="</span>"+htmlEncode(s[e])+'<span class="ipa-unit">';continue}if("."===s[e]){i+='</span><span class="ipa-dot">.</span><span class="ipa-unit">';continue}if("ËˆËŒÂ¹Â²".includes(s[e])){i+='</span><span class="ipa-stress-mark ipa-unit">'+htmlEncode(s[e])+'</span><span class="ipa-unit">';continue}if("êœœêœ›".includes(s[e])&&"Ë"===s[e+1]){i+='<span class="ipa-embedded-unit ipa-unit">'+s[e]+'</span>Ë</span><span class="ipa-unit">',e++;continue}for(var r=6;r>0&&(e+r>s.length||!data.ipa[s.substr(e,r)]);r--);if(0===r){i+='</span><span class="ipa-unit">'+htmlEncode(s[e])+'</span><span class="ipa-unit">';continue}let a=data.ipa[s.substr(e,r)];a.startsWith("M")||a.startsWith("Z")?i+=htmlEncode(s.substr(e,r)):(i+=l?htmlEncode(s.substr(e,r)):'</span><span class="ipa-unit">'+htmlEncode(s.substr(e,r)),l=a.startsWith("P")),e+=r-1}i='<span class="ipa-unit">'+i+"</span>",i=i.replace(/([Ë¥Ë¦Ë§Ë¨Ë©])<\/span><span class="ipa-unit">(?=[Ë¥Ë¦Ë§Ë¨Ë©])/g,"$1").replace(/<span class="ipa-unit"><\/span>/g,""),i=i.normalize("NFC"),e.find("span.ipa-display").html(i),e.find("span.ipa-unit").click((function(){$(this).hasClass("ipa-unit-indirect-highlight")||($(".ipa-unit-highlight").removeClass("ipa-unit-highlight"),$(".ipa-unit-indirect-highlight").removeClass("ipa-unit-indirect-highlight"),$(this).addClass("ipa-unit-highlight").parent(".ipa-unit").addClass("ipa-unit-indirect-highlight"),onIpaUnitClick())})).hover((function(){$(this).addClass("ipa-unit-highlight").parent(".ipa-unit").addClass("ipa-unit-indirect-highlight")}),(function(){$(this).removeClass("ipa-unit-highlight").parent(".ipa-unit").removeClass("ipa-unit-indirect-highlight")}));let c=n.left+t.width()/2-e.width()/2;c=Math.min(c,a.width()-e.width()-5),c=Math.max(c,5);let o=n.top+t.height()+10;explainerShowing=!0,e.css("left",c).css("top",o),e.show(200).focus()}function onIpaUnitClick(){const e=$("span.ipa-unit.ipa-unit-highlight:not(.ipa-unit-indirect-highlight)").clone().children().remove().end().text().normalize("NFD");let a=[],t=[];if(/^[Ë¥Ë¦Ë§Ë¨Ë©]+$/.test(e))a.push({text:e,data:""});else for(let n=0;n<e.length;n++){for(var s=6;s>0&&(n+s>e.length||!data.ipa[e.substr(n,s)]);s--);if(0===s)break;let i=data.ipa[e.substr(n,s)];if(i.startsWith("#")){let e=i.substr(1).trim().split(" ");for(let s=0;s<e.length;s++)a.push({text:e[s],data:data.ipa[e[s]]}),t.push(data.ipa[e[s]])}else if(i.includes("#")){let e=i.indexOf("#");t.push(i.substr(0,e).trim());let s=i.substr(e+1).trim().split(" ");for(let e=0;e<s.length;e++)a.push({text:s[e],data:data.ipa[s[e]]})}else a.push({text:e.substr(n,s),data:data.ipa[e.substr(n,s)]}),t.push(data.ipa[e.substr(n,s)]);n+=s-1}const n=$("#ipa-explainer-container");n.find(".ipa-detail-placeholder").addClass("hidden");const i=n.find(".ipa-detail");i.html("").removeClass("hidden"),a.splice(0,0,{text:e,data:t.join(" ")});let l=0;for(let e=1;e<a.length;e++)if(a[e-l].data.startsWith("Z")){let t=a.splice(e-l,1);a.splice(a.length,0,t[0]),l++}for(let e=0;e<a.length;e++){const s=a[e],n=$('<div class="ipa-detail-item level-'+(0===e?0:1)+'">');let l=s.text;if("â—Œ"===l)continue;"ÌƒÌˆÌ†ÌÌ‘ÌŠÌŒÍ†Í—Í‘Ì°Ì¤Ì®Ì©Ì¯Ì¥Ì¬ÌªÌºÌÌÌŸÌ Ì¹ÌœÌ¼Ì½Ì˜Ì™Ì»ÌÌ€Ì„ÌÌ‹Ì‚ÌŒá·…á·„á·ˆÌšÍ“Ì»áµŠË Ê°Ê²Ê·áµË¤Ë€Ë¢á¶»á¶´á¶¾á¶³á¶¼á¶á¶½ÊµÊ´ËËË‘â".includes(l[0])&&(l="â—Œ"+l),1===l.length&&"áµˆáµ—áµâ¿".includes(l[0])&&(l+="â—Œ"),l=l.normalize("NFC");const r=$('<span class="ipa" lang="fonipa">').text(l);let c;n.append($('<div class="ipa-detail-item-header">').append(r));for(let e=0;e<t.length;e++)if("CV".includes(t[e][0])){c=t[e][0];break}const o=$('<div class="ipa-detail-item-body">').text(getIpaName(s.text,s.data,c));if(n.append(o),i.append(n),0===e){if(!(a.length>2))break;{const e=$('<div class="ipa-detail-subheader no-select">').text(getString("ipa-detail-subheader"));i.append(e)}}}}function getIpaName(e,a,t){function s(e){for(;e.includes("  ");)e=e.replace("  "," ");return e=(e=e.trim())[0].toUpperCase()+e.substr(1)}if(data.strings["ipa-symbol-"+e])return s(getString("ipa-symbol-"+e));let n="ipa-symbol-after-"+("C"===t?"consonant":"V"===t?"vowel":"others")+"-"+e;if(data.strings[n])return s(getString(n));if(/^[Ë¥Ë¦Ë§Ë¨Ë©]+$/.test(e))return s(getString("ipa-symbol-tone-marks"));let i=a.split(" ");for(let e=0;e<i.length;e++){var l=i[e].match(/^([CV])\.(\d+)\.(\d+)(\.[a-zA-Z]+)?/);if(l)break}if(!l)return"";let r=l[1],c=parseInt(l[2]),o=parseInt(l[3]),p=(l[4]||".").substr(1).toLowerCase();for(let e=0;e<i.length;e++){const a=i[e].match(/^[MP]\.([+\-=<>0])(\d*)\.([+\-=<>0])(\d*)(\.(([+\-][a-zA-Z])+))?$/);if(a){switch(a[1]){case"+":c+=parseInt(a[2]);break;case"-":c-=parseInt(a[2]);break;case"=":c=parseInt(a[2]);break;case">":c+=Math.sign(parseInt(a[2])-c);break;case"<":c-=Math.sign(parseInt(a[2])-c)}switch(a[3]){case"+":o+=parseInt(a[4]);break;case"-":o-=parseInt(a[4]);break;case"=":o=parseInt(a[4]);break;case">":o+=Math.sign(parseInt(a[4])-o);break;case"<":o-=Math.sign(parseInt(a[4])-o)}if(a[5])for(let e=0;e<a[6].length/2;e++)"+"!==a[6][2*e]||p.includes(a[6][2*e+1])||(p+=a[6][2*e+1]),"-"===a[6][2*e]&&p.includes(a[6][2*e+1])&&(p=p.replace(a[6][2*e+1],""))}}if("C"===r){let e=getString("ipa-consonant-template");return e=e.replace("$1",data.strings["ipa-consonant-type-"+c+"-pos-"+o]?getString("ipa-consonant-type-"+c+"-pos-"+o):getString("ipa-consonant-type-"+c)),e=e.replace("$2",data.strings["ipa-consonant-pos-"+o+"-type-"+c]?getString("ipa-consonant-pos-"+o+"-type-"+c):getString("ipa-consonant-pos-"+o)),"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(a=>{let t="ipa-consonant-attr-"+a+"-"+(p.includes(a)?"true":"false");e=e.replace("$"+a,data.strings[t]?getString(t):"")}),s(e)}if("V"===r){let e=getString("ipa-vowel-template");return e=e.replace("$1",getString("ipa-vowel-openness-"+c)),e=e.replace("$2",getString("ipa-vowel-backness-"+o)),"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(a=>{let t="ipa-vowel-attr-"+a+"-"+(p.includes(a)?"true":"false");e=e.replace("$"+a,data.strings[t]?getString(t):"")}),s(e)}}function hideIpaExplainer(){explainerShowing=!1;const e=$("#ipa-explainer-container");e.hide(),e.find(".ipa-detail").addClass("hidden").html(""),e.find(".ipa-detail-placeholder").removeClass("hidden")}function onIndexItemClick(){isBusy||(isBusy=!0,activeItem=$(this).data("item"),activeItem&&animateLoadActiveItem())}function animateLoadActiveItem(){$(".content").animate({opacity:0},200,"linear",(function(){selfHashChange="#"+activeItem.title.replace("|","").replaceAll(" ","_"),window.location.hash=selfHashChange,$(".tab-selected").removeClass("tab-selected"),loadActiveItem(),$(".content").animate({opacity:1},200,"linear",(function(){isBusy=!1}))})),$("html").scrollTop()>$(".content").offset().top&&$("html").animate({scrollTop:$(".content").offset().top},300)}function langName(e){const a=data.strings["lang-"+e];return a&&(a[langLong]||a[langShort]||a.en)||e}function getString(e){const a=data.strings[e];return a?a[langLong]||a[langShort]||a.en:e}const translitRegex={zh:/^[>* ]*\{\{zh\|tran\}\} \{\{lang\|zh\|([^{|}]+)(\|[^{|}]*)*\}\}/};function getTranslitRegex(){return translitRegex[langLong]||translitRegex[langShort]}function htmlEncode(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function expandTemplates(e,a){"string"!=typeof e&&(e=e[langLong]||e[langShort]||e.en||""),e=e.replace(/ (\{\{(ref|audio|dialect))/g,"~$1");for(let s=0;s<e.length;s++)switch(e[s]){case"~":e=e.substring(0,s)+"&nbsp;"+e.substring(s+1),s+=5;break;case"{":if("{"===e[s+1]){const n=readTemplate(e,s);if(n){let i,l,r="",c=n.name;switch("tran"!==c&&data.strings["lang-"+c]&&(c="-lang"),c){case"-lang":let e=langName(n.name),s=e;for("aprx"!==n.args[0]&&"tran"!==n.args[0]||n.args.splice(0,1);n.args[0]&&n.args[0].endsWith("*");)n.args.splice(0,1);r='<span class="lang-code-light" lang="" title="'+s+'">'+n.name.replace(/\+.+/,"")+"</span> "+n.args.map(e=>expandTemplates("{{tag"+("orig"===e?"-green":e.startsWith("need-")?"-red":"")+"|"+getString("tag-"+e)+"}}")).join(" ")+' <span class="lang-name">'+expandTemplates(e)+"</span>"+getString("colon"),i=!0,l=!0;break;case"audio":r='<span class="audio no-select">ğŸ”Š<audio preload="none" src="/audio/'+n.args[0]+'"></audio></span>';break;case"ipa":needIpaSelector=needIpaSelector||"std";let o=n.args.length>2?"<"+n.args.slice(1).join("/")+">":n.args[1];/<[^>]*\/[^>]*\//.test(o)&&(needIpaSelector="audio"),r='<span class="ipa" lang="fonipa" data-lang="'+htmlEncode(n.args[0])+'" data-src="'+htmlEncode(o)+'"></span>',i=!0;break;case"ipb":r='<span class="ipa ipa-broad" lang="fonipa" data-lang="'+htmlEncode(n.args[0])+'" data-src="'+htmlEncode(n.args[1])+'"></span>',i=!0;break;case"ipc":r='<span class="ipa ipa-keep" lang="fonipa" data-src="'+htmlEncode(n.args[0])+'"></span>',i=!0;break;case"ipd":r='<span class="ipa ipa-keep ipa-display" lang="fonipa" data-src="'+htmlEncode(n.args[0])+'"></span>',i=!0;break;case"lang":var t=["ar","fa","he","yi"].includes(n.args[0]);if(r='<span lang="'+n.args[0]+'"'+(t?' dir="rtl"':"")+">"+n.args[1]+"</span>",n.args[2]){if("index"===a)break;r+=' (<span class="translit" lang="'+n.args[0]+'-Latn">'+expandTemplates(n.args[2])+"</span>)"}break;case"lang*":if("index"!==a){l=!0;break}t=["ar","fa","he","yi"].includes(n.args[0]);r='<span lang="'+n.args[0]+'"'+(t?' dir="rtl"':"")+">"+n.args[1]+"</span>";break;case"lang-code":r='<span class="lang-code-light" lang="" title="'+langName(n.args[0])+'">'+n.args[0]+"</span>",i=!0;break;case"link":r='<a target="_blank" href="'+encodeURI(n.args[0])+'">'+(n.args[1]?expandTemplates(n.args[1]).replaceAll("_"," "):htmlEncode(n.args[0]))+"</a>",i=!0;break;case"raise":r='<span style="line-height:1;vertical-align:'+encodeURI(n.args[0])+';">'+expandTemplates(n.args[1])+"</span>",i=!0;break;case"ref":case"note":let p=n.args.join("|"),d=0;d=/^\d+$/.test(p)?parseInt(p):activeReferences.indexOf(p)+1,0===d&&(d=activeReferences.push(p)),r='<sup><span class="ref-link" data-ref="ref-'+d+'">['+("ref"===c?"":getString("note"))+d+"]</span></sup>";break;case"require":r='<div data-require="'+htmlEncode(n.args[0])+'"><span class="content-ajax-loading">'+getString("content-ajax-loading")+"</span></div>";break;case"ruby":r="<ruby><rb>"+expandTemplates(n.args[0])+"</rb><rp> (</rp><rt>"+expandTemplates(n.args[1])+"</rt><rp>) </rp></ruby>",i=!0;break;case"small":r='<span class="smaller">'+expandTemplates(n.args.join(" "))+"</span>",i=!0;break;case"stat":r='<span class="stat">'+(stats[n.args[0]]||"")+"</span>",i=!0;break;case"string":if(r=(data.strings[n.args[0]]?getString(n.args[0]):n.args[1]||"").replaceAll("$$","[$$]"),r){for(let e=1;e<n.args.length&&e<10;e++)r=r.replaceAll("$"+e,n.args[e]);r=r.replaceAll("[$$]","$")}break;case"tag":case"tag-red":case"tag-green":r='<span class="text-'+c+'">'+expandTemplates(n.args.join(" "))+"</span>",i=!0;break;default:let h=data.templates[n.name];if(h&&h.en&&(h=h[langLong]||h[langShort]||h[en]),h&&h[n.args.length]){let e=h[n.args.length];"object"==typeof e&&(e=e[langLong]||e[langShort]||e.en),r=e.replaceAll("$$","[$$]");for(let e=0;e<n.args.length&&e<9;e++)r=r.replaceAll("$"+(e+1),n.args[e]);r=r.replaceAll("[$$]","$")}}let o=e.substring(n.endPosition);l&&(o=o.trim()),e=e.substring(0,s)+r+o,i&&(s+=r.length),s--}}}return"ipa"===a&&(e='<span class="ipa-word">'+e+"</span>"),e}function debugIpa(e,a){return $("<div>").html(getIpa(a||"",e,"std")).text()}function getIpa(e,a,t){if(e=e.normalize("NFD"),"debug"===t)return'<span class="ipa-debug">['+htmlEncode(e)+"]</span>";let s=t.replace("*","");"keep"!==t&&["before",a,"after"].forEach(t=>{"audio"===s&&t===a&&ipaConversion[t]&&ipaConversion[t].std&&ipaConversion[t].std.forEach(a=>e=e.replace(a[0],a[1])),ipaConversion[t]&&ipaConversion[t][s]&&ipaConversion[t][s].forEach(a=>e=e.replace(a[0],a[1]))});for(let a=0;a<e.length;a++)switch(e[a]){case"Ëˆ":case"ËŒ":case"Â¹":case"Â²":e=e.substring(0,a)+'<span class="ipa-stress-mark">'+e[a]+"</span>"+e.substring(a+1),a+=37;break;case".":e=e.substring(0,a)+'<span class="ipa-dot">.</span>'+e.substring(a+1),a+=29;break;case"=":"std"===t||"audio"===t?(e=e.substring(0,a)+'</span><span class="ipa-liaison">â€¿</span><span class="ipa-word">'+e.substring(a+1),a+=61):(e=e.substring(0,a)+'</span><span class="ipa-liaison">â€¿</span><span class="ipa-word-non-interactive">'+e.substring(a+1),a+=67);break;case" ":"std"===t||"audio"===t?(e=e.substring(0,a)+'</span><span class="ipa-space"> </span><span class="ipa-word">'+e.substring(a+1),a+=59):(e=e.substring(0,a)+'</span><span class="ipa-space"> </span><span class="ipa-word-non-interactive">'+e.substring(a+1),a+=65)}return e="std"===t||"audio"===t?'<span class="ipa-word">'+e+"</span>":'<span class="ipa-word-non-interactive">'+e+"</span>","std"===t||"std*"===t||"audio"===t?e='<span class="ipa-delimiter">[</span>'+e+'<span class="ipa-delimiter">]</span>':"keep"!==t&&(e='<span class="ipa-delimiter">/</span>'+e+'<span class="ipa-delimiter">/</span>'),(e=e.replace(/bÍ¡Î²/g,"bÍ¡?").replace(/tÍ¡Î¸/g,"tÍ¡?").replace(/qÍ¡Ï‡/g,"qÍ¡?")).normalize("NFC")}function readTemplate(e,a){let t=a,s=[],n="",i="",l=0;for(;"{"===e[t];)t++;for(;t<e.length;t++)if("|"===e[t]&&0===l)n?s.push(i):n=i,i="";else if("{"===e[t]&&"{"===e[t+1])l++,t++,i+="{{";else if("}"===e[t]&&"}"===e[t+1]){if(!(l>0))return n?s.push(i):n=i,{name:n,args:s,endPosition:t+2};l--,t++,i+="}}"}else i+=e[t]}